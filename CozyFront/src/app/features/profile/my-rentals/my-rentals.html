<div class="container mt-5 ">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="mb-0">Mis alquileres</h2>
    <div class="btn-group">
      <button class="btn btn-outline-primary" [class.active]="vista === 'lista'" (click)="toggleVista('lista')">
        <i class="bi bi-list"></i> 
      </button>
      <button class="btn btn-outline-primary" [class.active]="vista === 'card'" (click)="toggleVista('card')">
        <i class="bi bi-grid-3x3-gap"></i>
      </button>
    </div>
  </div>

  <!-- Vista Lista -->
  <div *ngIf="vista === 'lista'">
    <table class="table table-hover">
      <thead class="table-light">
        <tr>
          <th>Distrito</th>
          <th>Dirección</th>
          <th>Fecha inicio</th>
          <th>Fecha fin</th>
          <th>Precio</th>
          <th>Estado</th>
          <th class="border-start"></th>
          <th>Último Pago</th>
          <th>Estado pago</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let rental of rentals">
          <td>{{ rental.districtName }}</td>
          <td>
            {{ rental.streetName }}
            <span *ngIf="rental.portal">, {{ rental.portal }}</span>
            <span *ngIf="rental.floor">, {{ rental.floor }}</span>
            <span *ngIf="rental.apartmentDoor">, {{ rental.apartmentDoor }}</span>
          </td>
          <td>{{ rental.startDate | date:'dd/MM/yyyy' }}</td>
          <td>{{ rental.endDate | date:'dd/MM/yyyy' }}</td>
          <td>{{ rental.apartmentPrice | currency:'EUR':'symbol':'1.0-0' }}</td>
          <td>
            <span class="badge bg-info">{{ rental.statusName }}</span>
          </td>
          <td class="border-start"></td>
          <td>
            <span *ngIf="rental.paymentDate">{{ rental.paymentDate | date:'dd/MM/yyyy' }}</span>
            <span *ngIf="!rental.paymentDate">-</span>
          </td>
          <td>
            <span class="badge" [ngClass]="{
              'bg-success': rental.paymentStatusName === 'Pagado',
              'bg-danger': rental.paymentStatusName === 'Impagado',
              'bg-warning': rental.paymentStatusName !== 'Pagado' && rental.paymentStatusName !== 'Impagado'
            }">{{ rental.paymentStatusName || '-' }}</span>
          </td>
          <td>
            <button *ngIf="rental.paymentStatusId === 'U' || rental.paymentStatusName === 'Impago'" class="btn btn-primary btn-sm" (click)="openPaymentForm(rental)">Pagar</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Vista Cards -->
  <div *ngIf="vista === 'card'" class="row g-4">
    <div class="col-md-6 col-lg-4" *ngFor="let apartment of apartments">
      <app-cards [apartment]="apartment"></app-cards>
    </div>
  </div>
</div>
<div #paymentModal class="modal fade" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <app-payment-form
        [rental]="selectedRental"
        (paymentSuccess)="closePaymentForm()"
        (paymentCancel)="closePaymentForm()">
      </app-payment-form>
    </div>
  </div>
</div>
